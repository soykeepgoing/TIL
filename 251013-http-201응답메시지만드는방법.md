# 배경

`201 Created` 응답 메서드는 일반적으로 **새로 생성된 리소스의 URI**를 반환한다.

그런데 나는 메시지로 잘 생성되었다는 것과 포스트 아이디를 던져주고 싶었다. 

gemini의 힘을 빌려 한번 찾아봤다. 

# 분석

**responseDto**

```java
    public static PostCreateResponse of(int postId) {
        return new PostCreateResponse(
                "게시글이 성공적으로 생성되었습니다.", 
                postId,
                "/posts/" + postId
        );
    }
```

`PostCreateResponse`는 정적 팩토리 메서드(`of`)를 사용했다. 

생성자를 직접 노출하지 않고 간접적으로 객체를 생성할 수 있다. 

`of()`메서드에서는 

- 메시지
- 반환할 게시글 아이디
- 새로 생성된 게시글로 리다이렉션한 URI를 함께 정의한다.

**service**

```java
Public PostCreateResponse createPost(PostCreateRequest request){
	...
	int postId = postCsvRepository.savePost(postEntity);
	return PostCreateResponse.of(postId);
}
```

서비스 계층에서는 게시글 저장 후 반환된 `postId`를 파라미터로 `PostResponse.of()`를 호출한다. 

controller

```java
ResponseEntity<PostCreateResponse> createPost(Long userId, PostCreateRequest request){
	PostCreateResponse postCreateResponse = postsService.createPost(userId, postCreateRequest);
	return ResponseEntity
					.created(URI.create(postCreateResponse.getRedirectUri()))
					.body(postCreateResponse);
}	
```

그러고 나서 위와 같이 설정할 수 있다. 

1. `created()`는 `URI` 객체를 인자로 받는다. POST 요청으로 생성된 리소스의 위치를 나타낸다. 
2. `.body()`안에는 클라이언트에게 보낼 응답이 들어간다. 

# 결과

1. `of()`함수는 처음 사용해봤는데 깔끔하고 직관적인것 같다고 느꼈다. 응답 바디를 만드는 로직이 은직되어서 컨트롤러, 서비스 계층에서 불필요한 코드를 만들지 않아도 됐다. 
2. `created`에서 `URI`를 단순 string으로 해준다고 생각했는데 따로 객체를 사용해야 한다. 메시지와 리소스 경로가 포함된 body도 전달해줄 수 있다.